% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utlis.R
\name{make_group_without_period}
\alias{make_group_without_period}
\title{Construct Grouping Factor Excluding a Period Term}
\usage{
make_group_without_period(fml, data, period = "f_tk", state_var = NULL)
}
\arguments{
\item{fml}{A one‐ or two‐sided formula with fixed and/or random effects,
e.g. `~ f_yr + (1|f_site)`.}

\item{data}{A `data.frame` containing all variables in `fml`.}

\item{period}{A string naming the period variable to exclude (default: `"f_tk"`).}

\item{state_var}{Optional string naming a state variable; if not `NULL`,
also excludes `"f_tl"`.}
}
\value{
A factor of length `nrow(data)` representing the interaction of all
  non‐period (and non‐`f_tl` if `state_var` is used) variables. If no
  variables remain, returns a single‐level factor.
}
\description{
Builds an interaction‐based grouping factor from all fixed‐ and random‐effect
variables in a formula, dropping any specified period variable (e.g., `f_tk`)
and—if `state_var` is provided—also dropping the state variable `f_tl`.
}
\examples{
#--- Setup sample data with both f_tk (time) and f_tl (state) plus other covariates:
df <- data.frame(
  f_tk  = rep(1:2, each = 6),
  f_tl  = rep(c("A","B","C"), times = 4),
  f_yr  = factor(rep(2010:2012, length.out = 12)),
  f_site = factor(rep(1:3, times = 4))
)

# 1) Drop only f_tk (period)—group by f_tl, f_yr, f_site:
grp_period_only <- make_group_without_period(~ f_tl + f_yr + (1|f_site), df)
table(grp_period_only)

# 2) Drop only f_tl via state_var—group by f_tk, f_yr, f_site:
grp_state_only <- make_group_without_period(~ f_tk + f_yr + (1|f_site),
                                           df,
                                           period = "f_tk",
                                           state_var = "f_tl")
table(grp_state_only)

# 3) Drop both f_tk and f_tl—group only by f_yr and f_site:
grp_both <- make_group_without_period(~ f_yr + (1|f_site),
                                     df,
                                     period = "f_tk",
                                     state_var = "f_tl")
table(grp_both)

# 4) No other covariates—should return a single level:
grp_none <- make_group_without_period(~ (1|f_site),
                                     df,
                                     period = "f_tk",
                                     state_var = "f_tl")
table(grp_none)

}
